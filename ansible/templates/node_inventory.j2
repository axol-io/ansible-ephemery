---
# Node Inventory File - generated by Ephemery backup playbook
# Backup timestamp: {{ backup_timestamp }}
# Hostname: {{ inventory_hostname }}

node_info:
  backup_timestamp: {{ backup_timestamp }}
  hostname: {{ inventory_hostname }}
  ip_address: {{ ansible_default_ipv4.address }}
  os_family: {{ ansible_os_family }}
  os_distribution: {{ ansible_distribution }}
  os_version: {{ ansible_distribution_version }}
  ansible_user: {{ ansible_user }}

ephemery_config:
  data_dir: {{ data_dir | default('/opt/ephemery') }}
  network_id: {{ network_id | default('13337') }}
  chain_id: {{ chain_id | default('13337') }}
  network_name: {{ ephemery_network | default('ephemery') }}

client_config:
{% if el_client_name is defined %}
  execution_client:
    name: {{ el_client_name }}
    version: {% if el_client_name == 'geth' %}{{ geth_version | default('N/A') }}{% elif el_client_name == 'nethermind' %}{{ nethermind_version | default('N/A') }}{% elif el_client_name == 'besu' %}{{ besu_version | default('N/A') }}{% elif el_client_name == 'erigon' %}{{ erigon_version | default('N/A') }}{% else %}unknown{% endif %}
    data_dir: {% if el_client_name == 'geth' %}{{ geth_data_dir | default('N/A') }}{% elif el_client_name == 'nethermind' %}{{ nethermind_data_dir | default('N/A') }}{% elif el_client_name == 'besu' %}{{ besu_data_dir | default('N/A') }}{% elif el_client_name == 'erigon' %}{{ erigon_data_dir | default('N/A') }}{% else %}unknown{% endif %}
    http_enabled: {{ el_http_enabled | default(false) | bool }}
    http_port: {{ el_http_port | default(8545) }}
    ws_enabled: {{ el_ws_enabled | default(false) | bool }}
    ws_port: {{ el_ws_port | default(8546) }}
{% endif %}

{% if cl_client_name is defined %}
  consensus_client:
    name: {{ cl_client_name }}
    version: {% if cl_client_name == 'lighthouse' %}{{ lighthouse_version | default('N/A') }}{% elif cl_client_name == 'prysm' %}{{ prysm_version | default('N/A') }}{% elif cl_client_name == 'teku' %}{{ teku_version | default('N/A') }}{% elif cl_client_name == 'nimbus' %}{{ nimbus_version | default('N/A') }}{% elif cl_client_name == 'lodestar' %}{{ lodestar_version | default('N/A') }}{% else %}unknown{% endif %}
    data_dir: {% if cl_client_name == 'lighthouse' %}{{ lighthouse_data_dir | default('N/A') }}{% elif cl_client_name == 'prysm' %}{{ prysm_data_dir | default('N/A') }}{% elif cl_client_name == 'teku' %}{{ teku_data_dir | default('N/A') }}{% elif cl_client_name == 'nimbus' %}{{ nimbus_data_dir | default('N/A') }}{% elif cl_client_name == 'lodestar' %}{{ lodestar_data_dir | default('N/A') }}{% else %}unknown{% endif %}
    http_port: {{ cl_http_port | default(5052) }}
    p2p_port: {{ cl_p2p_port | default(9000) }}
{% endif %}

{% if validator_client_name is defined %}
  validator_client:
    name: {{ validator_client_name }}
    version: {{ validator_client_version | default('N/A') }}
    data_dir: {{ validator_data_dir | default('N/A') }}
{% endif %}

backup_info:
  backup_files:
{% for item in backup_files %}
    - path: {{ item.path }}
      type: {{ item.type }}
      required: {{ item.required }}
      filename: {{ item.type }}_backup.tar.gz
{% endfor %}
  local_backup_dir: {{ local_backup_dir }}/{{ inventory_hostname }}_{{ backup_timestamp }}/
